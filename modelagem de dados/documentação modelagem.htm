<html><style>body {
color: #000000;
background-color: #FFFFFF;
font-size: 24;
font-family: Serif;
font-weight: bold;
font-style: italic;
}
h1, h2, h3, h4, h5, h6 {
color: #000000;
background-color: #FFFFFF;
font-size: 24;
font-family: Serif;
font-weight: bold;
font-style: italic;
}
table, pre {
color: #000000;
background-color: #FFFFFF;
font-size: 16;
font-family: Serif;
font-weight: normal;
font-style: normal;
}

ul, #myUL {
  list-style-type: none;
}

#myUL {
  margin: 0;
  padding: 0;
}

.caret, .dropDownCaret {
  cursor: pointer;
}

.caret::before {
	content: "\25B6";
	color: black;
	display: inline - block;
	margin - right: 6px;
}

.dropDownCaret::before {
	content: "\25BC";
	color: black;
	display: inline - block;
	margin - right: 6px;
	float: right;
}


.nested {
  display: none;
}

.active {
  display: block;
}
</style><body><br></br><h1><div>Power BI Documentation</div></h1><br></br><hr></hr><h2><div>Generated by <a href="http://radacad.com/power-bi-helper">Power BI Helper</a> (Copyright &copy; <a href="http://radacad.com">RADACAD</a>).</div><br></br><div>Date: 20/04/2025 16:26:24</div><br></br></h2><h1><div>------------------******   Model    ******---------------------</div></h1><br></br><h2><div>Model: modelagem de dados</div></h2><br></br><hr></hr><br></br><h3><div>List of Tables:</div></h3><br></br><table border='1px' cellpadding='1' cellspacing='1'><tr ><td >Name</td><td >Description</td><td >Storage Mode</td><td >Source</td><td >Is Hidden</td></tr><tr ><td >Cliente</td><td ></td><td >Import</td><td ><pre>let
    Fonte = Excel.Workbook(File.Contents("C:\Users\luizr\OneDrive\Área de Trabalho\PowerBI-ModelagemDeDados-Aula1-Material\Base de dados - Power BI Modelagem de dados.xlsx"), null, true),
    Cliente_Table = Fonte{[Item="Cliente",Kind="Table"]}[Data],
    #"Tipo Alterado" = Table.TransformColumnTypes(Cliente_Table,{{"ClienteKey", type number}})
in
    #"Tipo Alterado"</pre></td><td >False</td></tr><tr ><td >Produto</td><td ></td><td >Import</td><td ><pre>let
    Fonte = Excel.Workbook(File.Contents("C:\Users\luizr\OneDrive\Área de Trabalho\PowerBI-ModelagemDeDados-Aula1-Material\Base de dados - Power BI Modelagem de dados.xlsx"), null, true),
    Produto_Table = Fonte{[Item="Produto",Kind="Table"]}[Data],
    #"Tipo Alterado" = Table.TransformColumnTypes(Produto_Table,{{"Preço listado", Currency.Type}, {"Custo padrão", Currency.Type}})
in
    #"Tipo Alterado"</pre></td><td >False</td></tr><tr ><td >Revendedor</td><td ></td><td >Import</td><td ><pre>let
    Fonte = Excel.Workbook(File.Contents("C:\Users\luizr\OneDrive\Área de Trabalho\PowerBI-ModelagemDeDados-Aula1-Material\Base de dados - Power BI Modelagem de dados.xlsx"), null, true),
    Revendedor_Table = Fonte{[Item="Revendedor",Kind="Table"]}[Data]
in
    Revendedor_Table</pre></td><td >False</td></tr><tr ><td >Vendas</td><td ></td><td >Import</td><td ><pre>let
    Fonte = Excel.Workbook(File.Contents("C:\Users\luizr\OneDrive\Área de Trabalho\PowerBI-ModelagemDeDados-Aula1-Material\Base de dados - Power BI Modelagem de dados.xlsx"), null, true),
    Vendas_Table = Fonte{[Item="Vendas",Kind="Table"]}[Data],
    #"Consultas Mescladas" = Table.NestedJoin(Vendas_Table, {"PedidosKey"}, PedidoVendas, {"PedidosKey"}, "PedidoVendas", JoinKind.LeftOuter),
    #"PedidoVendas Expandido" = Table.ExpandTableColumn(#"Consultas Mescladas", "PedidoVendas", {"Canal", "Pedido de venda", "Pedidos"}, {"Canal", "Pedido de venda", "Pedidos"}),
    #"Tipo Alterado" = Table.TransformColumnTypes(#"PedidoVendas Expandido",{{"PedidosKey", Int64.Type}, {"RevendedorKey", Int64.Type}, {"PedidoVendaData", type date}, {"VencimentoData", type date}, {"EntregaData", type text}, {"Preço unitário", Currency.Type}, {"Custo", Currency.Type}}),
    #"Valor Substituído" = Table.ReplaceValue(#"Tipo Alterado","/","",Replacer.ReplaceText,{"EntregaData"}),
    #"Tipo Alterado1" = Table.TransformColumnTypes(#"Valor Substituído",{{"VencimentoData", type text}, {"PedidoVendaData", type text}}),
    #"Valor Substituído1" = Table.ReplaceValue(#"Tipo Alterado1","/","",Replacer.ReplaceText,{"PedidoVendaData"}),
    #"Valor Substituído2" = Table.ReplaceValue(#"Valor Substituído1","/","",Replacer.ReplaceText,{"VencimentoData"}),
    #"Colunas Renomeadas" = Table.RenameColumns(#"Valor Substituído2",{{"EntregaData", "EntregaDataKey"}, {"VencimentoData", "VencimentoDataKey"}, {"PedidoVendaData", "PedidoVendaDataKey"}})
in
    #"Colunas Renomeadas"</pre></td><td >True</td></tr><tr ><td >VendasTerritorio</td><td ></td><td >Import</td><td ><pre>let
    Fonte = Excel.Workbook(File.Contents("C:\Users\luizr\OneDrive\Área de Trabalho\PowerBI-ModelagemDeDados-Aula1-Material\Base de dados - Power BI Modelagem de dados.xlsx"), null, true),
    VendasTerritorio_Table = Fonte{[Item="VendasTerritorio",Kind="Table"]}[Data]
in
    VendasTerritorio_Table</pre></td><td >False</td></tr><tr ><td >Estoque</td><td ></td><td >Import</td><td ><pre>let
    Fonte = Excel.Workbook(File.Contents("C:\Users\luizr\OneDrive\Área de Trabalho\PowerBI-ModelagemDeDados-Aula1-Material\Estoque - Power BI Modelagem de dados.xlsx"), null, true),
    Estoque_Table = Fonte{[Item="Estoque",Kind="Table"]}[Data],
    #"Tipo Alterado" = Table.TransformColumnTypes(Estoque_Table,{{"Data atualização", type text}}),
    #"Valor Substituído" = Table.ReplaceValue(#"Tipo Alterado","/","",Replacer.ReplaceText,{"Data atualização"}),
    #"Colunas Renomeadas" = Table.RenameColumns(#"Valor Substituído",{{"Data atualização", "Data atualizaçãoKey"}})
in
    #"Colunas Renomeadas"</pre></td><td >True</td></tr><tr ><td >Calendário</td><td ></td><td >Import</td><td ><pre>ADDCOLUMNS(
    CALENDAR("01/01/2017","01/01/2022"),
    "Data Key", CONCATENATE(
        FORMAT([Date], "dd"),
        CONCATENATE(
            FORMAT([Date], "mm"),
            FORMAT([Date], "yyyy")
        )
    )
)</pre></td><td >False</td></tr><tr ><td >Medidas</td><td ></td><td >Import</td><td ><pre>Row("Column", BLANK())</pre></td><td >False</td></tr></table><hr></hr><br></br><h3><div>List of Measures:</div></h3><br></br><table border="1" cellpadding="3">
	<tr>
		<th>Measure Name</th>
		<th>Table Name</th>
		<th>Description</th>
		<th>Expression</th>
		<th>Dependency</th>
		<th>Reverse Dependency</th>
	</tr>
	<tr>
		<td>Total Entregas</td>
		<td>Medidas</td>
		<td></td>
		<td><pre>CALCULATE(
                    COUNTROWS(Vendas),
                    USERELATIONSHIP('Calendário'[Data Key],
                    Vendas[EntregaDataKey])
)</pre></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: Total Entregas</span><span class="dropDownCaret">
<ul class="nested">
<li><span class="caret">Table: Vendas</span>
<ul class="nested">
<li>M_Expression: PedidoVendas (Table: )</li>
</ul></li>
<li>Column: EntregaDataKey (Table: Vendas)</li>
<li>Calc_Table: Calendário (Table: Calendário)</li>
<li>Calc_Column: Data Key (Table: Calendário)</li>
</ul></span></li>
</ul></td>
		<td>Measure: Total Entregas</td>
	</tr>
	<tr>
		<td>Total Pedidos</td>
		<td>Medidas</td>
		<td></td>
		<td><pre>CALCULATE(
                    COUNTROWS(Vendas),
                    USERELATIONSHIP('Calendário'[Data Key],
                    Vendas[PedidoVendaDataKey])
)</pre></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: Total Pedidos</span><span class="dropDownCaret">
<ul class="nested">
<li><span class="caret">Table: Vendas</span>
<ul class="nested">
<li>M_Expression: PedidoVendas (Table: )</li>
</ul></li>
<li>Column: PedidoVendaDataKey (Table: Vendas)</li>
<li>Calc_Table: Calendário (Table: Calendário)</li>
<li>Calc_Column: Data Key (Table: Calendário)</li>
</ul></span></li>
</ul></td>
		<td>Measure: Total Pedidos</td>
	</tr>
</table>
<hr></hr><br></br><h3><div>List of Columns for Table Cliente:</div></h3><br></br><table border="1" cellpadding="3">
	<tr>
		<th>Column Name</th>
		<th>Description</th>
		<th>Calculated Column</th>
		<th>Expression</th>
	</tr>
	<tr>
		<td>Cliente</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>Cidade</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>Estado</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>Pa&#237;s</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>C&#243;digo postal</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
</table>
<hr></hr><br></br><h3><div>List of Columns for Table Produto:</div></h3><br></br><table border="1" cellpadding="3">
	<tr>
		<th>Column Name</th>
		<th>Description</th>
		<th>Calculated Column</th>
		<th>Expression</th>
	</tr>
	<tr>
		<td>SKU</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>Produto</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>Custo padr&#227;o</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>Cor</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>Pre&#231;o listado</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>Modelo</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>Categoria</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>Subcategoria</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
</table>
<hr></hr><br></br><h3><div>List of Columns for Table Revendedor:</div></h3><br></br><table border="1" cellpadding="3">
	<tr>
		<th>Column Name</th>
		<th>Description</th>
		<th>Calculated Column</th>
		<th>Expression</th>
	</tr>
	<tr>
		<td>Tipo de neg&#243;cio</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>Revendedor</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>Cidade</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>Estado - Provincia</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>Pa&#237;s</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>C&#243;digo postal</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
</table>
<hr></hr><br></br><h3><div>List of Columns for Table VendasTerritorio:</div></h3><br></br><table border="1" cellpadding="3">
	<tr>
		<th>Column Name</th>
		<th>Description</th>
		<th>Calculated Column</th>
		<th>Expression</th>
	</tr>
	<tr>
		<td>Regiao</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>Pa&#237;s</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>Continente</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
</table>
<hr></hr><br></br><h3><div>List of Columns for Table Calendário:</div></h3><br></br><table border="1" cellpadding="3">
	<tr>
		<th>Column Name</th>
		<th>Description</th>
		<th>Calculated Column</th>
		<th>Expression</th>
	</tr>
	<tr>
		<td>Date</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
</table>
<hr></hr><br></br><h3><div>List of Columns for Table Medidas:</div></h3><br></br><table border="1" cellpadding="3">
	<tr>
		<th>Column Name</th>
		<th>Description</th>
		<th>Calculated Column</th>
		<th>Expression</th>
	</tr>
</table>
<hr></hr><br></br><h3><div>List of Roles:</div></h3><br></br><table border="1" cellpadding="3">
	<tr>
		<th>Role Name</th>
		<th>Table Name</th>
		<th>Description</th>
		<th>Expression</th>
	</tr>
</table>
<hr></hr><br></br><h3><div>Relationships:</div></h3><br></br><table border='1px' cellpadding='1' cellspacing='1'><tr ><td >Name</td><td >CrossFilteringBehavior</td><td >FromCardinality</td><td >FromColumn</td><td >FromTable</td><td >IsActive</td><td >IsRemoved</td><td >JoinOnDateBehavior</td><td >RelyOnReferentialIntegrity</td><td >SecurityFilteringBehavior</td><td >State</td><td >ToCardinality</td><td >ToColumn</td><td >ToTable</td><td >Type</td></tr><tr ><td >AutoDetected_543343c2-aa37-4d65-853c-1af2629a8c33</td><td >OneDirection</td><td >Many</td><td >ClienteKey</td><td >Vendas</td><td >True</td><td >False</td><td >DateAndTime</td><td >False</td><td >OneDirection</td><td >Ready</td><td >One</td><td >ClienteKey</td><td >Cliente</td><td >SingleColumn</td></tr><tr ><td >AutoDetected_a23eebd0-f8fc-44cf-aa98-4a1df3219f36</td><td >OneDirection</td><td >Many</td><td >ProdutoKey</td><td >Vendas</td><td >True</td><td >False</td><td >DateAndTime</td><td >False</td><td >OneDirection</td><td >Ready</td><td >One</td><td >ProdutoKey</td><td >Produto</td><td >SingleColumn</td></tr><tr ><td >AutoDetected_2abef704-3e6c-4288-9fab-6c49714c63a9</td><td >OneDirection</td><td >Many</td><td >RevendedorKey</td><td >Vendas</td><td >True</td><td >False</td><td >DateAndTime</td><td >False</td><td >OneDirection</td><td >Ready</td><td >One</td><td >RevendedorKey</td><td >Revendedor</td><td >SingleColumn</td></tr><tr ><td >AutoDetected_f1d40c2f-0fb0-4476-82f1-ae48bfe1ed2e</td><td >OneDirection</td><td >Many</td><td >VendasTerritorioKey</td><td >Vendas</td><td >True</td><td >False</td><td >DateAndTime</td><td >False</td><td >OneDirection</td><td >Ready</td><td >One</td><td >VendasTerritorioKey</td><td >VendasTerritorio</td><td >SingleColumn</td></tr><tr ><td >b719b16c-fa69-1c61-9747-0c703342e654</td><td >OneDirection</td><td >Many</td><td >ProdutoKey</td><td >Estoque</td><td >True</td><td >False</td><td >DateAndTime</td><td >False</td><td >OneDirection</td><td >Ready</td><td >One</td><td >ProdutoKey</td><td >Produto</td><td >SingleColumn</td></tr><tr ><td >24be14bc-cbc9-4390-a59c-3b17ddbf856d</td><td >OneDirection</td><td >Many</td><td >Data atualizaçãoKey</td><td >Estoque</td><td >True</td><td >False</td><td >DateAndTime</td><td >False</td><td >OneDirection</td><td >Ready</td><td >One</td><td >Data Key</td><td >Calendário</td><td >SingleColumn</td></tr><tr ><td >c84d9ed1-a850-bca4-fa26-9d68f9fe51d0</td><td >OneDirection</td><td >Many</td><td >VencimentoDataKey</td><td >Vendas</td><td >False</td><td >False</td><td >DateAndTime</td><td >False</td><td >OneDirection</td><td >Ready</td><td >One</td><td >Data Key</td><td >Calendário</td><td >SingleColumn</td></tr><tr ><td >71d0ef6f-f7db-fa05-4bd8-653da55db761</td><td >OneDirection</td><td >Many</td><td >PedidoVendaDataKey</td><td >Vendas</td><td >True</td><td >False</td><td >DateAndTime</td><td >False</td><td >OneDirection</td><td >Ready</td><td >One</td><td >Data Key</td><td >Calendário</td><td >SingleColumn</td></tr><tr ><td >2838f6c8-8bde-8bc5-2aed-382ed93f88b6</td><td >OneDirection</td><td >Many</td><td >EntregaDataKey</td><td >Vendas</td><td >False</td><td >False</td><td >DateAndTime</td><td >False</td><td >OneDirection</td><td >Ready</td><td >One</td><td >Data Key</td><td >Calendário</td><td >SingleColumn</td></tr></table><hr></hr><br></br><h2><div>M (Power Query) Script:</div></h2><br></br><br></br><font face="verdana" size="2"<div>Cliente<br></br><br></br><font color="blue">let</font><br></br>    Fonte = <font color="purple">Excel.Workbook</font>(<font color="purple">File.Contents</font>("C:\Users\luizr\OneDrive\Área de Trabalho\PowerBI-ModelagemDeDados-Aula1-Material\Base de dados - Power BI Modelagem de dados.xlsx"), <font color="blue">null</font>, <font color="blue">true</font>),<br></br>    Cliente_Table = Fonte{[Item=<font color="red">"Cliente"</font>,Kind=<font color="red">"Table"</font>]}[Data],<br></br>    #<font color="red">"Tipo Alterado"</font> = <font color="purple">Table.TransformColumnTypes</font>(Cliente_Table,{{<font color="red">"ClienteKey"</font>, <font color="blue">type</font> number}})<br></br><font color="blue">in</font><br></br>    #<font color="red">"Tipo Alterado"</font><br></br><br></br><br></br>----------------------<br></br>Produto<br></br><br></br><font color="blue">let</font><br></br>    Fonte = <font color="purple">Excel.Workbook</font>(<font color="purple">File.Contents</font>("C:\Users\luizr\OneDrive\Área de Trabalho\PowerBI-ModelagemDeDados-Aula1-Material\Base de dados - Power BI Modelagem de dados.xlsx"), <font color="blue">null</font>, <font color="blue">true</font>),<br></br>    Produto_Table = Fonte{[Item=<font color="red">"Produto"</font>,Kind=<font color="red">"Table"</font>]}[Data],<br></br>    #<font color="red">"Tipo Alterado"</font> = <font color="purple">Table.TransformColumnTypes</font>(Produto_Table,{{<font color="red">"Preço listado"</font>, <font color="purple">Currency.Type</font>}, {<font color="red">"Custo padrão"</font>, <font color="purple">Currency.Type</font>}})<br></br><font color="blue">in</font><br></br>    #<font color="red">"Tipo Alterado"</font><br></br><br></br><br></br>----------------------<br></br>Revendedor<br></br><br></br><font color="blue">let</font><br></br>    Fonte = <font color="purple">Excel.Workbook</font>(<font color="purple">File.Contents</font>("C:\Users\luizr\OneDrive\Área de Trabalho\PowerBI-ModelagemDeDados-Aula1-Material\Base de dados - Power BI Modelagem de dados.xlsx"), <font color="blue">null</font>, <font color="blue">true</font>),<br></br>    Revendedor_Table = Fonte{[Item=<font color="red">"Revendedor"</font>,Kind=<font color="red">"Table"</font>]}[Data]<br></br><font color="blue">in</font><br></br>    Revendedor_Table<br></br><br></br><br></br>----------------------<br></br>Vendas<br></br><br></br><font color="blue">let</font><br></br>    Fonte = <font color="purple">Excel.Workbook</font>(<font color="purple">File.Contents</font>("C:\Users\luizr\OneDrive\Área de Trabalho\PowerBI-ModelagemDeDados-Aula1-Material\Base de dados - Power BI Modelagem de dados.xlsx"), <font color="blue">null</font>, <font color="blue">true</font>),<br></br>    Vendas_Table = Fonte{[Item=<font color="red">"Vendas"</font>,Kind=<font color="red">"Table"</font>]}[Data],<br></br>    #<font color="red">"Consultas Mescladas"</font> = <font color="purple">Table.NestedJoin</font>(Vendas_Table, {<font color="red">"PedidosKey"</font>}, PedidoVendas, {<font color="red">"PedidosKey"</font>}, <font color="red">"PedidoVendas"</font>, <font color="purple">JoinKind.LeftOuter</font>),<br></br>    #<font color="red">"PedidoVendas Expandido"</font> = <font color="purple">Table.ExpandTableColumn</font>(#<font color="red">"Consultas Mescladas"</font>, <font color="red">"PedidoVendas"</font>, {<font color="red">"Canal"</font>, <font color="red">"Pedido de venda"</font>, <font color="red">"Pedidos"</font>}, {<font color="red">"Canal"</font>, <font color="red">"Pedido de venda"</font>, <font color="red">"Pedidos"</font>}),<br></br>    #<font color="red">"Tipo Alterado"</font> = <font color="purple">Table.TransformColumnTypes</font>(#<font color="red">"PedidoVendas Expandido"</font>,{{<font color="red">"PedidosKey"</font>, <font color="purple">Int64.Type</font>}, {<font color="red">"RevendedorKey"</font>, <font color="purple">Int64.Type</font>}, {<font color="red">"PedidoVendaData"</font>, <font color="blue">type</font> <font color="blue">date</font>}, {<font color="red">"VencimentoData"</font>, <font color="blue">type</font> <font color="blue">date</font>}, {<font color="red">"EntregaData"</font>, <font color="blue">type</font> <font color="blue">text</font>}, {<font color="red">"Preço unitário"</font>, <font color="purple">Currency.Type</font>}, {<font color="red">"Custo"</font>, <font color="purple">Currency.Type</font>}}),<br></br>    #<font color="red">"Valor Substituído"</font> = <font color="purple">Table.ReplaceValue</font>(#<font color="red">"Tipo Alterado"</font>,<font color="red">"/"</font>,<font color="red">""</font>,<font color="purple">Replacer.ReplaceText</font>,{<font color="red">"EntregaData"</font>}),<br></br>    #<font color="red">"Tipo Alterado1"</font> = <font color="purple">Table.TransformColumnTypes</font>(#<font color="red">"Valor Substituído"</font>,{{<font color="red">"VencimentoData"</font>, <font color="blue">type</font> <font color="blue">text</font>}, {<font color="red">"PedidoVendaData"</font>, <font color="blue">type</font> <font color="blue">text</font>}}),<br></br>    #<font color="red">"Valor Substituído1"</font> = <font color="purple">Table.ReplaceValue</font>(#<font color="red">"Tipo Alterado1"</font>,<font color="red">"/"</font>,<font color="red">""</font>,<font color="purple">Replacer.ReplaceText</font>,{<font color="red">"PedidoVendaData"</font>}),<br></br>    #<font color="red">"Valor Substituído2"</font> = <font color="purple">Table.ReplaceValue</font>(#<font color="red">"Valor Substituído1"</font>,<font color="red">"/"</font>,<font color="red">""</font>,<font color="purple">Replacer.ReplaceText</font>,{<font color="red">"VencimentoData"</font>}),<br></br>    #<font color="red">"Colunas Renomeadas"</font> = <font color="purple">Table.RenameColumns</font>(#<font color="red">"Valor Substituído2"</font>,{{<font color="red">"EntregaData"</font>, <font color="red">"EntregaDataKey"</font>}, {<font color="red">"VencimentoData"</font>, <font color="red">"VencimentoDataKey"</font>}, {<font color="red">"PedidoVendaData"</font>, <font color="red">"PedidoVendaDataKey"</font>}})<br></br><font color="blue">in</font><br></br>    #<font color="red">"Colunas Renomeadas"</font><br></br><br></br><br></br>----------------------<br></br>VendasTerritorio<br></br><br></br><font color="blue">let</font><br></br>    Fonte = <font color="purple">Excel.Workbook</font>(<font color="purple">File.Contents</font>("C:\Users\luizr\OneDrive\Área de Trabalho\PowerBI-ModelagemDeDados-Aula1-Material\Base de dados - Power BI Modelagem de dados.xlsx"), <font color="blue">null</font>, <font color="blue">true</font>),<br></br>    VendasTerritorio_Table = Fonte{[Item=<font color="red">"VendasTerritorio"</font>,Kind=<font color="red">"Table"</font>]}[Data]<br></br><font color="blue">in</font><br></br>    VendasTerritorio_Table<br></br><br></br><br></br>----------------------<br></br>Estoque<br></br><br></br><font color="blue">let</font><br></br>    Fonte = <font color="purple">Excel.Workbook</font>(<font color="purple">File.Contents</font>("C:\Users\luizr\OneDrive\Área de Trabalho\PowerBI-ModelagemDeDados-Aula1-Material\Estoque - Power BI Modelagem de dados.xlsx"), <font color="blue">null</font>, <font color="blue">true</font>),<br></br>    Estoque_Table = Fonte{[Item=<font color="red">"Estoque"</font>,Kind=<font color="red">"Table"</font>]}[Data],<br></br>    #<font color="red">"Tipo Alterado"</font> = <font color="purple">Table.TransformColumnTypes</font>(Estoque_Table,{{<font color="red">"Data atualização"</font>, <font color="blue">type</font> <font color="blue">text</font>}}),<br></br>    #<font color="red">"Valor Substituído"</font> = <font color="purple">Table.ReplaceValue</font>(#<font color="red">"Tipo Alterado"</font>,<font color="red">"/"</font>,<font color="red">""</font>,<font color="purple">Replacer.ReplaceText</font>,{<font color="red">"Data atualização"</font>}),<br></br>    #<font color="red">"Colunas Renomeadas"</font> = <font color="purple">Table.RenameColumns</font>(#<font color="red">"Valor Substituído"</font>,{{<font color="red">"Data atualização"</font>, <font color="red">"Data atualizaçãoKey"</font>}})<br></br><font color="blue">in</font><br></br>    #<font color="red">"Colunas Renomeadas"</font><br></br><br></br><br></br>----------------------<br></br>Calendário<br></br><br></br>ADDCOLUMNS(<br></br>    CALENDAR(<font color="red">"01/01/2017"</font>,<font color="red">"01/01/2022"</font>),<br></br>    <font color="red">"Data Key"</font>, CONCATENATE(<br></br>        FORMAT([Date], <font color="red">"dd"</font>),<br></br>        CONCATENATE(<br></br>            FORMAT([Date], <font color="red">"mm"</font>),<br></br>            FORMAT([Date], <font color="red">"yyyy"</font>)<br></br>        )<br></br>    )<br></br>)<br></br><br></br><br></br>----------------------<br></br>Medidas<br></br><br></br>Row(<font color="red">"Column"</font>, BLANK())<br></br><br></br><br></br>----------------------<br></br></font></div><br></br><hr></hr><br></br><h3><div>Partitions:</div></h3><br></br><table border='1px' cellpadding='1' cellspacing='1'><tr ><td >Name</td><td >QueryDefinition</td></tr><tr ><td >Cliente</td><td ><font color="blue">let</font><br></br>    Fonte = <font color="purple">Excel.Workbook</font>(<font color="purple">File.Contents</font>("C:\Users\luizr\OneDrive\Área de Trabalho\PowerBI-ModelagemDeDados-Aula1-Material\Base de dados - Power BI Modelagem de dados.xlsx"), <font color="blue">null</font>, <font color="blue">true</font>),<br></br>    Cliente_Table = Fonte{[Item=<font color="red">"Cliente"</font>,Kind=<font color="red">"Table"</font>]}[Data],<br></br>    #<font color="red">"Tipo Alterado"</font> = <font color="purple">Table.TransformColumnTypes</font>(Cliente_Table,{{<font color="red">"ClienteKey"</font>, <font color="blue">type</font> number}})<br></br><font color="blue">in</font><br></br>    #<font color="red">"Tipo Alterado"</font></td></tr><tr ><td >Produto</td><td ><font color="blue">let</font><br></br>    Fonte = <font color="purple">Excel.Workbook</font>(<font color="purple">File.Contents</font>("C:\Users\luizr\OneDrive\Área de Trabalho\PowerBI-ModelagemDeDados-Aula1-Material\Base de dados - Power BI Modelagem de dados.xlsx"), <font color="blue">null</font>, <font color="blue">true</font>),<br></br>    Produto_Table = Fonte{[Item=<font color="red">"Produto"</font>,Kind=<font color="red">"Table"</font>]}[Data],<br></br>    #<font color="red">"Tipo Alterado"</font> = <font color="purple">Table.TransformColumnTypes</font>(Produto_Table,{{<font color="red">"Preço listado"</font>, <font color="purple">Currency.Type</font>}, {<font color="red">"Custo padrão"</font>, <font color="purple">Currency.Type</font>}})<br></br><font color="blue">in</font><br></br>    #<font color="red">"Tipo Alterado"</font></td></tr><tr ><td >Revendedor</td><td ><font color="blue">let</font><br></br>    Fonte = <font color="purple">Excel.Workbook</font>(<font color="purple">File.Contents</font>("C:\Users\luizr\OneDrive\Área de Trabalho\PowerBI-ModelagemDeDados-Aula1-Material\Base de dados - Power BI Modelagem de dados.xlsx"), <font color="blue">null</font>, <font color="blue">true</font>),<br></br>    Revendedor_Table = Fonte{[Item=<font color="red">"Revendedor"</font>,Kind=<font color="red">"Table"</font>]}[Data]<br></br><font color="blue">in</font><br></br>    Revendedor_Table</td></tr><tr ><td >Vendas</td><td ><font color="blue">let</font><br></br>    Fonte = <font color="purple">Excel.Workbook</font>(<font color="purple">File.Contents</font>("C:\Users\luizr\OneDrive\Área de Trabalho\PowerBI-ModelagemDeDados-Aula1-Material\Base de dados - Power BI Modelagem de dados.xlsx"), <font color="blue">null</font>, <font color="blue">true</font>),<br></br>    Vendas_Table = Fonte{[Item=<font color="red">"Vendas"</font>,Kind=<font color="red">"Table"</font>]}[Data],<br></br>    #<font color="red">"Consultas Mescladas"</font> = <font color="purple">Table.NestedJoin</font>(Vendas_Table, {<font color="red">"PedidosKey"</font>}, PedidoVendas, {<font color="red">"PedidosKey"</font>}, <font color="red">"PedidoVendas"</font>, <font color="purple">JoinKind.LeftOuter</font>),<br></br>    #<font color="red">"PedidoVendas Expandido"</font> = <font color="purple">Table.ExpandTableColumn</font>(#<font color="red">"Consultas Mescladas"</font>, <font color="red">"PedidoVendas"</font>, {<font color="red">"Canal"</font>, <font color="red">"Pedido de venda"</font>, <font color="red">"Pedidos"</font>}, {<font color="red">"Canal"</font>, <font color="red">"Pedido de venda"</font>, <font color="red">"Pedidos"</font>}),<br></br>    #<font color="red">"Tipo Alterado"</font> = <font color="purple">Table.TransformColumnTypes</font>(#<font color="red">"PedidoVendas Expandido"</font>,{{<font color="red">"PedidosKey"</font>, <font color="purple">Int64.Type</font>}, {<font color="red">"RevendedorKey"</font>, <font color="purple">Int64.Type</font>}, {<font color="red">"PedidoVendaData"</font>, <font color="blue">type</font> <font color="blue">date</font>}, {<font color="red">"VencimentoData"</font>, <font color="blue">type</font> <font color="blue">date</font>}, {<font color="red">"EntregaData"</font>, <font color="blue">type</font> <font color="blue">text</font>}, {<font color="red">"Preço unitário"</font>, <font color="purple">Currency.Type</font>}, {<font color="red">"Custo"</font>, <font color="purple">Currency.Type</font>}}),<br></br>    #<font color="red">"Valor Substituído"</font> = <font color="purple">Table.ReplaceValue</font>(#<font color="red">"Tipo Alterado"</font>,<font color="red">"/"</font>,<font color="red">""</font>,<font color="purple">Replacer.ReplaceText</font>,{<font color="red">"EntregaData"</font>}),<br></br>    #<font color="red">"Tipo Alterado1"</font> = <font color="purple">Table.TransformColumnTypes</font>(#<font color="red">"Valor Substituído"</font>,{{<font color="red">"VencimentoData"</font>, <font color="blue">type</font> <font color="blue">text</font>}, {<font color="red">"PedidoVendaData"</font>, <font color="blue">type</font> <font color="blue">text</font>}}),<br></br>    #<font color="red">"Valor Substituído1"</font> = <font color="purple">Table.ReplaceValue</font>(#<font color="red">"Tipo Alterado1"</font>,<font color="red">"/"</font>,<font color="red">""</font>,<font color="purple">Replacer.ReplaceText</font>,{<font color="red">"PedidoVendaData"</font>}),<br></br>    #<font color="red">"Valor Substituído2"</font> = <font color="purple">Table.ReplaceValue</font>(#<font color="red">"Valor Substituído1"</font>,<font color="red">"/"</font>,<font color="red">""</font>,<font color="purple">Replacer.ReplaceText</font>,{<font color="red">"VencimentoData"</font>}),<br></br>    #<font color="red">"Colunas Renomeadas"</font> = <font color="purple">Table.RenameColumns</font>(#<font color="red">"Valor Substituído2"</font>,{{<font color="red">"EntregaData"</font>, <font color="red">"EntregaDataKey"</font>}, {<font color="red">"VencimentoData"</font>, <font color="red">"VencimentoDataKey"</font>}, {<font color="red">"PedidoVendaData"</font>, <font color="red">"PedidoVendaDataKey"</font>}})<br></br><font color="blue">in</font><br></br>    #<font color="red">"Colunas Renomeadas"</font></td></tr><tr ><td >VendasTerritorio</td><td ><font color="blue">let</font><br></br>    Fonte = <font color="purple">Excel.Workbook</font>(<font color="purple">File.Contents</font>("C:\Users\luizr\OneDrive\Área de Trabalho\PowerBI-ModelagemDeDados-Aula1-Material\Base de dados - Power BI Modelagem de dados.xlsx"), <font color="blue">null</font>, <font color="blue">true</font>),<br></br>    VendasTerritorio_Table = Fonte{[Item=<font color="red">"VendasTerritorio"</font>,Kind=<font color="red">"Table"</font>]}[Data]<br></br><font color="blue">in</font><br></br>    VendasTerritorio_Table</td></tr><tr ><td >Estoque</td><td ><font color="blue">let</font><br></br>    Fonte = <font color="purple">Excel.Workbook</font>(<font color="purple">File.Contents</font>("C:\Users\luizr\OneDrive\Área de Trabalho\PowerBI-ModelagemDeDados-Aula1-Material\Estoque - Power BI Modelagem de dados.xlsx"), <font color="blue">null</font>, <font color="blue">true</font>),<br></br>    Estoque_Table = Fonte{[Item=<font color="red">"Estoque"</font>,Kind=<font color="red">"Table"</font>]}[Data],<br></br>    #<font color="red">"Tipo Alterado"</font> = <font color="purple">Table.TransformColumnTypes</font>(Estoque_Table,{{<font color="red">"Data atualização"</font>, <font color="blue">type</font> <font color="blue">text</font>}}),<br></br>    #<font color="red">"Valor Substituído"</font> = <font color="purple">Table.ReplaceValue</font>(#<font color="red">"Tipo Alterado"</font>,<font color="red">"/"</font>,<font color="red">""</font>,<font color="purple">Replacer.ReplaceText</font>,{<font color="red">"Data atualização"</font>}),<br></br>    #<font color="red">"Colunas Renomeadas"</font> = <font color="purple">Table.RenameColumns</font>(#<font color="red">"Valor Substituído"</font>,{{<font color="red">"Data atualização"</font>, <font color="red">"Data atualizaçãoKey"</font>}})<br></br><font color="blue">in</font><br></br>    #<font color="red">"Colunas Renomeadas"</font></td></tr><tr ><td >Calendário</td><td >ADDCOLUMNS(<br></br>    CALENDAR(<font color="red">"01/01/2017"</font>,<font color="red">"01/01/2022"</font>),<br></br>    <font color="red">"Data Key"</font>, CONCATENATE(<br></br>        FORMAT([Date], <font color="red">"dd"</font>),<br></br>        CONCATENATE(<br></br>            FORMAT([Date], <font color="red">"mm"</font>),<br></br>            FORMAT([Date], <font color="red">"yyyy"</font>)<br></br>        )<br></br>    )<br></br>)</td></tr><tr ><td >Medidas</td><td >Row(<font color="red">"Column"</font>, BLANK())</td></tr></table><script>
	var toggler = document.getElementsByClassName("caret");
	for (var i = 0; i < toggler.length; i++){
		toggler[i].addEventListener("click", function() {
			this.parentElement.querySelector(".nested").classList.toggle("active");
		});
	}
		
	var togglerAll = document.getElementsByClassName("dropDownCaret");
	for (var j=0; j<togglerAll.length; j++){
		togglerAll[j].addEventListener("click", function(event){
			if (event.currentTarget != event.target) return;
			if(this.parentElement.querySelector(".nested").classList.contains("active")){
				this.querySelectorAll(".nested").forEach(function(currentValue, currentIndex, listObj) {
					if(currentValue.classList.contains("active")){
						currentValue.classList.remove("active");
					}
				});
			}
			else{
				this.querySelectorAll(".nested").forEach(function(currentValue, currentIndex, listObj) {
					if(!currentValue.classList.contains("active")){
						currentValue.classList.add("active");
					}
				});
			}
		});
	}
</script></body></html>